
# FleXgeo

The FleXgeo is a software package designed for protein conformational ensemble analyses based on a differential geometry representation of protein backbones. The package is composed of a binary of the core program which calculates the differential geometry descriptors (more details bellow) and a set of scripts designed for the analyses of the results.

## How to run it?
There are two stages of FleXgeo applications, the differential geometry descriptors calculation and the analyses part. A website with tutorials will be provided in the future, but for now check the **quick and dirt** guide:
- **1 . Calculate Differential Geometry**
	>$ /path/to/FleXgeo_bin -pdb=ensemble.pdb [options]

FleXgeo accepts the following arguments:

|    OPTIONS       | DESCRIPTION               | DEFAULT                 |
|----------------|-----------------------------|--------------------------|
|`-pdb=[filename.pdb]`|Set input .pdb filename|User must provide  |
|`-ncpus=[int]`      |Set the number of cpus FleXgeo will use | All cpus available|
| `-isSingle`        |Indicate if input pdb is a single conformation pdb | FALSE|
|`-outprfx=[prefix]` | Set the output files prefix to be used | 'Diffgeo_' |

 - **2. Analyses**
	* Plot xgeo data
		>$ python3.5 /path/to/PlotFXgeoData.py DiffGeo_raw.csv

	* Calculate distance between all conformations and a reference conformation on the ensemble
		>$ python3.5 /path/to/CalcEnsDistFromRef.py -in=XgeoObjFilname.p

	* Calculate distance between all conformations and an external reference conformation
		>$ python3.5 /path/to/CalcEnsDistFromRef.py -in=XgeoObjFilname.p -ext_ref=/path/to/ref_xgeo.csv

	* Calculate residues Max Euclidean distance observed (dMax)
		* Eliminate extreme bins outliers using a percentage treshold [default = 1% of the total conformations on the ensemble]
		>$ luajit /path/to/HistProc.lua

		NOTE: This lua script will use the "Diffgeo_stat.lua" file generated by FleXgeo as input and output a "DiffGeoSpec.ssv". This ".ssv" contains the lenght of the interval to be considered on each dimension for dMax.

		* Compute dMax for each residue
		>$ python3.5 /path/to/ComputeResDMax.py

		NOTE: this script use "DiffGeoSpec.ssv" as input to compute the dMax and outputs:
		1) "maxdt.csv" : the dMax values per residues
		2) "aa_list.csv" : the most flexible residues detected (more details bellow)
		3) "z-score.csv": the dMax z-score used on most flexible residues detection

		PS: In addition to computation of dMax, this script also run a Haar Wavelet transformation of the Z-score of residues dMax in order to automatically identify the most flexible residues.


	* [TO ADD] Clustering by HDBScan

## What are the contents of the output files?
FleXgeo outputs 5 .csvs files:

[ADICIONAR DESCRIÃ‡AO]

## How to cite?
If you use results produced by FleXgeo on your amazing publication, please cite:
[adicionar paper]

## Why just binaries files for the core of FleXgeo?
Unfortunatly, we use Numerical Recipies on our code and we are not allowed to distribute the source code. We plan to rewrite those part of the code in the future, but this is not on our top priorities right now. If you have some trouble on running a binary file on your machine, feel free to contact Antonio at amarinho@cent.uw.edu.pl and we can try to provide an specific binary for you.
